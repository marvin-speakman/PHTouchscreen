import React, { Component } from 'react';
// import { Link } from 'react-router-dom';
import './ap-ride-plan.css';
//import rideTopDown from './img/ride_plan.png';
import touchText from './img/touchText.png';
import touchArrow from './img/touchArrow.png';
import $ from 'jquery';
// import {withRouter} from "react-router-dom";
// import {BrowserRouter as Router, Route, Switch, history} from 'react-router-dom';


var plotProps;
// var viewLink;
// var plotInfo;
class ApRidePlan extends Component {
    constructor(props) {
        super(props);
        plotProps = props.properties;
    }
    render() {

        /***
 * Alderley Park Plots Selector
 ***/

        var isTouch = false;
        var touched;
        var formPrice;
        
        $('.site').on('touchstart', function () {
            isTouch = true;
            setTimeout(function () {
                touched = false;
            }, 300);
        });

        $('.js-plot-selector').on('click', 'path', function () {
            
            // var $plotSelector = $('.js-plot-selector');
            var plotId = $(this).closest('svg').data('property-id');
            // var $selectedEl = $(this).closest('svg');
            $('#plot-selector .ap-site-map__description').css('opacity', '1');
            $('svg').removeClass('active');
            $(this).closest('svg').addClass('active');
            $.each(plotProps, function (index, value) {
                if (plotProps[index].id === plotId) {
                    $('.infoHolder').css('display', 'none');
                    $('#ID' + plotId).css('display', 'block');
                }
            });
        });
        $(".viewRi").off().on("click", function() {
            $('iframe').attr('src', ''); 
            var curSlug = '/plot/' + $(this).attr('id');
            $('.holds-the-iframe').css('right', '0px');
            // setTimeout(function () {
               $('iframe').attr('src', curSlug); 
            // }, 2000);
        });

        function commafy( num ) {
			var str = num.toString().split('.');
			if (str[0].length >= 5) {
				str[0] = str[0].replace(/(\d)(?=(\d{3})+$)/g, '$1,');
			}
			if (str[1] && str[1].length >= 5) {
				str[1] = str[1].replace(/(\d{3})/g, '$1 ');
			}
			
			formPrice = str;
			return str.join('.');
        }
        
        function trimURL2(url){
            var surl = url.substring(51);
            // console.log("new: " + surl);
            return surl;
        }

        return (
            <div id="plot-selector">
                <script>window.onload = function() {document.body.scrollTop = document.documentElement.scrollTop = 0};</script>
               

                <div className="touchHouse rideTouch">
                    <img className="touchText"src={touchText} />
                    <img className="touchArrow" src={touchArrow}/>
                </div>
                {   this.props.properties.map(function(object,i) {
                    var pid = 'ID' + object.id;
                    var price = object.acf.price;
                    var plotImg = object.better_featured_image.media_details.sizes.medium.source_url;
                    commafy(price);
                    return (
                        <div className='ap-site-map__description infoHolder' id={pid} key={pid}>
                            <div className="plotNumber">Plot {object.acf.plot_number}</div>
                            <img id="plotImg" src={trimURL2(plotImg)}/>
                            <h2 className="plotName">{object.title.rendered}</h2>
                            <p className="description">{object.acf.floor_area + 'sqft, ' + object.acf.bedrooms + ' bedrooms, ' + object.acf.bathrooms + ' bathrooms ' + object.acf.description}</p>
                            
                                {object.acf.availability == 'available' &&
                                 <h2 className="price"> Â£{formPrice}</h2>
                                }
                            
                            <h2 className="availability">Availability: {object.acf.availability}</h2>
                            {object.acf.availability == 'available' &&
                                <div className="viewRi sans" id={object.slug}>
                                    View Details
                                </div> 
                            }
                            {object.acf.availability == 'not-released' &&
                                <div className="viewRi sans" id={object.slug}>
                                    View Details
                                </div> 
                            }
                        </div>
                    )
                    }
                )}
                
                <div className="alderley-top-down alderley-top-down--the-ride">


                {/*<!-- Plot 1 -->*/}
                <svg className="js-plot-selector" data-property-id="1089" xmlns="http://www.w3.org/2000/svg" width="1169.333" height="1724" viewBox="0 0 1169.3333 1724">
                    <path x="0" y="0" width="1169.333" height="1724" fill="#00483A" d="M404.375 1717.667c-2.568-7.968-9.978-35.92-22.004-83-5.152-20.167-14.234-53.767-20.183-74.667-11.676-41.015-17.516-55.467-29.319-72.54-8.602-12.443-28.11-31.42-41.781-40.646-21.486-14.497-50.975-26.856-76.543-32.08-7.01-1.432-13.302-3.159-13.981-3.838-.68-.68-7.792-53.658-15.808-117.732-37.033-296.05-57.696-448.634-81.227-599.83C76.263 518.142-.634 10.39.004 9.752c.21-.211 82.842-2.202 183.624-4.425l183.24-4.041 169.333 6.76c221.044 8.826 428.482 17.99 429.466 18.974.429.43 13.316 84.768 28.638 187.42 21.525 144.208 39.38 272.123 78.534 562.64l50.675 376 22.647 261.045c12.456 143.575 22.463 261.23 22.237 261.455-.225.225-22.262 1.626-48.97 3.114-26.708 1.487-197.83 12.29-380.27 24.005-182.44 11.715-331.941 21.3-332.225 21.3-.285 0-1.436-2.85-2.558-6.333z"/> 
                </svg>
                
                {/*<!-- Plot 2 -->*/}
                <svg className="js-plot-selector" data-property-id="1104" xmlns="http://www.w3.org/2000/svg" width="880" height="665.333" viewBox="0 0 880 665.33331">
                    <path x="0" y="0" width="880" height="665.333" fill="#00483A" d="M59.905 657.64c1.805-16.585 2.601-194 1.016-226.36C55.47 319.998 36.888 198.584 7.46 81.946 3.204 65.08-.15 51.14.005 50.97.453 50.48 658.44 8.384 714.113 5.283c27.5-1.531 53.565-3.344 57.922-4.028 4.357-.683 8.134-1.03 8.394-.77.661.66 97.64 622.616 97.157 623.1-.216.215-180.336 9.355-400.266 20.31-219.93 10.955-404.009 20.26-409.063 20.678l-9.19.76z"/>
                </svg>
                
                {/*<!-- Plot 3 -->*/}
                <svg className="js-plot-selector" data-property-id="1105" xmlns="http://www.w3.org/2000/svg" width="846.667" height="552" viewBox="0 0 846.66669 552">
                    <path x="0" y="0" width="846.667" height="552" fill="#00483A" d="M.777 548.12c1.084-5.421 4.462-40.42 6.809-70.548 8.03-103.096 15.61-251.123 19.527-381.334.86-28.6 2.043-52.532 2.629-53.184C30.766 41.916 844.352.506 845.386 1.54c.687.688-3.689 67.526-4.508 68.851-.358.579-4.558 104.727-9.335 231.44-4.777 126.714-9.144 230.848-9.705 231.409-.56.56-167.485 4.603-370.943 8.984-203.457 4.38-388.141 8.372-410.409 8.87L0 552z"/>
                </svg>
                
                {/*<!-- Plot 4 -->*/}
                <svg className="js-plot-selector" data-property-id="1106" xmlns="http://www.w3.org/2000/svg" width="1150.667" height="1264" viewBox="0 0 1150.6667 1264">
                    <path x="0" y="0" width="1150.667" height="1264" fill="#00483A" d="M511.477 1257.901c-16.132-16.552-65.517-58.357-103.277-87.425-40.025-30.812-91.56-66.017-122.789-83.879-66.284-37.914-164.691-72.712-261.802-92.576-12.79-2.616-23.413-4.913-23.604-5.104-.191-.192 5.045-33.326 11.635-73.632C78.275 507.757 131.09 174.374 148.19 53.337c2.642-18.699 5.225-34.381 5.74-34.85C154.879 17.62 976.936-.376 977.762.45c.62.621-11.42 348.908-12.1 350-.302.485-6.605 3.858-14.006 7.496-8.318 4.088-13.456 7.393-13.456 8.656 0 1.123 21.654 54.684 48.12 119.024 26.467 64.34 47.873 117.745 47.57 118.677-.304.933-6.509 3.81-13.788 6.396-12.161 4.318-13.214 4.967-12.964 8 .149 1.815 32.33 73.8 71.512 159.967 39.183 86.166 71.161 156.75 71.062 156.853-.374.389-631.523 328.48-631.897 328.48-.217 0-3.068-2.744-6.338-6.099z"/>
                </svg>
                
                {/*<!-- Plot 5 -->*/}
                <svg className="js-plot-selector" data-property-id="1107" xmlns="http://www.w3.org/2000/svg" width="935.62439" height="1136.592" viewBox="0 0 935.62439 1136.592">
                    <path x="0" y="0" width="935.62439" height="1136.592" fill="#00483A" d="M140.261 979.219c-39.29-86.554-71.132-158.166-70.76-159.135.375-.968 6.437-3.68 13.477-6.026 7.04-2.346 13.118-5.09 13.505-6.1.53-1.381-50.179-126.57-94.7-233.793L0 569.868l14.612-7.328c8.035-4.03 14.613-7.77 14.615-8.312 0-.544 2.68-78.506 5.951-173.255 4.141-119.961 5.532-172.959 4.581-174.54L634.233 0c1.61.998 82.458 258.835 82.51 263.134 0 1.043-.665 3.793-1.502 6.11-1.44 3.979 1.318 11.056 49.946 128.178 40.657 97.924 162.144 384.752 164.767 389.015.58.947-.93 2.517-5.418 5.623-2.53 1.75-2.407 2.23 4.24 16.558l6.848 14.755-4.242 1.798c-2.332.987-105.127 44.67-228.43 97.073-161.78 68.755-224.735 94.934-226.148 94.044-1.075-.679-4.488-6.868-7.582-13.754-3.093-6.885-6.488-13.063-7.545-13.73-1.366-.862-34.458 13.18-114.653 48.65-62.004 27.425-113.279 50.72-113.946 51.765-.834 1.306.523 6.02 4.317 15.016 3.04 7.211 5.52 14.006 5.51 15.101 0 1.775-26.974 17.256-30.049 17.256-.636 0-33.305-70.819-72.595-157.373z"/>
                </svg>
                
                {/*<!-- Plot 6 -->*/}
                <svg className="js-plot-selector" data-property-id="1108" xmlns="http://www.w3.org/2000/svg" width="960" height="1093.333" viewBox="0 0 960 1093.3333">
                    <path  x="0" y="0" width="960" height="1093.333" fill="#00483A" d="M294.411 1091.667c-.366-.917-26.153-61.367-57.304-134.334-31.151-72.966-79.893-188.674-108.315-257.127l-51.677-124.46 1.734-5.254c1.984-6.013 7.342 12.461-47.898-165.159C13.503 349.233-.42 302.968.01 302.522c.43-.446 160.907-68.159 356.617-150.472C599.479 49.908 712.764 2.877 713.413 3.927c.523.846 4.721 16.059 9.33 33.806C752.958 154.076 799.698 318.01 817.478 370c8.841 25.853 34.66 90.776 72.643 182.667 54.232 131.199 60.66 147.622 64.183 163.945 4.654 21.569 3.719 61.23-2.28 96.721-3.294 19.483-12.94 59.16-15 61.689-1.687 2.072-380.146 150.34-383.705 150.322-1.236-.01-5.117-4.795-9.195-11.344-4.293-6.897-7.929-11.333-9.287-11.333-1.227 0-55.486 20.4-120.576 45.333s-118.533 45.333-118.764 45.333c-.232 0-.72-.75-1.086-1.666z"/>
                </svg>
                
                {/*<!-- Plot 7 -->*/}
                <svg className="js-plot-selector" data-property-id="1109" xmlns="http://www.w3.org/2000/svg" width="1061.333" height="912" viewBox="0 0 1061.3333 912">
                    <path x="0" y="0" width="1061.333" height="912" fill="#00483A" d="M307.656 907.919c-6.784-5.593-18.709-20.445-30.169-37.578-59.788-89.382-150.612-306.954-221.944-531.674C35.767 276.367 0 151.594 0 144.907c0-.334 6.15-.343 13.667-.019 137.045 5.913 475.24 18.735 475.93 18.043.512-.512-1.133-4.231-3.655-8.264-2.522-4.034-4.44-8.102-4.264-9.041.177-.94 46.822-34.02 103.655-73.51C662.974 18.165 689.053.687 690.22 1.822c2.33 2.266 368.45 520.95 368.437 521.967-.01.482-75.32 49.336-167.365 108.565L723.936 740.042l-205.289 85.98C405.737 873.308 313.189 912 312.983 912c-.207 0-2.603-1.837-5.327-4.081z"/>
                </svg>
                
                {/*<!-- Plot 8 -->*/}
                <svg className="js-plot-selector" data-property-id="1110" xmlns="http://www.w3.org/2000/svg" width="882.667" height="925.333" viewBox="0 0 882.66669 925.33331">
                    <path x="0" y="0" width="882.667" height="925.333" fill="#00483A" d="M184.366 665.9C83.543 523.21.583 405.503.012 404.325-1.573 401.058 154.185 2.062 156.853 2.553c1.693.312 707.824 261.547 718.531 265.823 2.017.805 3.667 2.35 3.667 3.432 0 3.042-19.031 50.237-31.336 77.709-41.618 92.915-103.052 203.96-169.235 305.896l-9.997 15.398-145.246 124.364c-79.885 68.4-147.566 125.668-150.401 127.261l-5.155 2.897z"/>
                </svg>
                
                {/*<!-- Plot 9 -->*/}
                <svg className="js-plot-selector" data-property-id="1111" xmlns="http://www.w3.org/2000/svg" width="906.667" height="1042.667" viewBox="0 0 906.66669 1042.6667">
                    <path x="0" y="0" width="906.66669" height="1042.6667" fill="#00483A" d="M 360.438,909.104 C 162.438,835.71 0.248,775.522 0.013,775.352 c -0.841,-0.61 38.697,-123.938 40.21,-125.42 1.16,-1.137 4.061,-0.9 11.549,0.943 16.634,4.096 16.7,4.074 19.106,-6.425 4.047,-17.666 92.42876,-381.2228 93.81776,-386.3808 1.73083,-1.07848 2.54281,0.63249 242.40924,26.66977 12.467,1.144 129.404,11.66 259.862,23.368 130.457,11.708 237.389,21.482 237.626,21.72 0.765,0.765 -30.686,140.44 -53.602,238.046 -45.393,193.35 -83.552,338.969 -114.14,435.57703 -9.203,29.068 -13.112,39.355 -14.9,39.215 -0.832,-0.065 -163.513,-60.16703 -361.513,-133.56003 z"/>
                </svg>
                
                {/*<!-- Plot 10 Updated -->*/}
                <svg className="js-plot-selector" data-property-id="1112" xmlns="http://www.w3.org/2000/svg" width="1080" height="1566.667" viewBox="0 0 1080 1566.6667">
                    <path x="0" y="0" width="1080" height="1566.6667" fill="#00483A" d="M789.613 1537.25c-78.713-17.364-135.27-29.238-136.117-28.577-.797.623-2.231 4.39-3.186 8.372-.956 3.982-2.183 7.961-2.728 8.843-.724 1.171-52.273-12.46-191.44-50.628-104.747-28.727-190.737-52.518-191.089-52.87-.352-.351.118-4.07 1.043-8.262 5.849-26.512 6.999-35.47 7.75-60.38.834-27.672-.298-42.595-4.976-65.594-9.246-45.448-27.284-81.979-53.011-107.357-13.39-13.208-28.308-23.57-47.58-33.046-33.589-16.516-66.854-24.305-119.563-27.992l-11.563-.81-.776-9.555c-.426-5.255-8.005-167.355-16.842-360.222-8.837-192.867-16.902-366.55-17.922-385.961-1.02-19.412-1.738-35.412-1.595-35.554.144-.143 162.861 5.685 361.595 12.95 198.733 7.266 361.958 12.982 362.721 12.703.764-.279 62.185-79.474 136.492-175.99C935.133 80.806 996.34 1.84 996.84 1.84s19.33 31.81 41.845 70.691l40.937 70.692-22.648 423.641c-18.51 346.211-24.01 441.432-30.093 520.976-5.498 71.895-7.972 98.417-9.465 101.479-1.111 2.28-21.98 88.05-46.376 190.6-24.396 102.549-44.897 186.585-45.558 186.747-.66.163-61.802-13.074-135.868-29.414z"/>
                </svg>
                
                {/*<!-- Plot 11 Updated -->*/}
                <svg className="js-plot-selector" data-property-id="1113" xmlns="http://www.w3.org/2000/svg" width="822.667" height="1018.667" viewBox="0 0 822.66669 1018.6667">
                    <path x="0" y="0" width="822.667" height="1018.667" fill="#00483A" d="M148.372 1018.292c-3.804-2.397-34.294-54.692-48.714-83.549-29.368-58.772-34.082-75.057-55.007-190-22.14-121.62-31.66-185.427-39.294-263.333L0 426.743l11.484-210C17.8 101.243 23.203 6.49 23.49 6.177c1.162-1.255 754.257 26.489 755.625 27.837.617.608 1.963 17.221 2.992 36.917 1.972 37.765 33.504 722.357 34.167 741.812l.386 11.334-24.667.888c-108.876 3.922-234.157 32.606-393.333 90.059-78.7 28.406-182.956 71.727-232.188 96.48-13.636 6.856-16.368 7.881-18.101 6.788z"/>
                </svg>
                
                {/*<!-- Plot 12 Updated -->*/}
                <svg className="js-plot-selector" data-property-id="1114" xmlns="http://www.w3.org/2000/svg" width="1213.333" height="1376" viewBox="0 0 1213.3333 1376">
                    <path x="0" y="0" width="1376" height="1724" fill="#00483A" d="M177.971 1375.643c0-.287-4.809-55.886-10.687-123.555l-10.688-123.035-50.684-376.112C66.658 461.65 48.944 334.737 27.362 190.178 12.038 87.518-.273 3.298.006 3.018.283 2.74 173.19 10.117 384.24 19.41c211.052 9.295 454.651 19.437 541.332 22.538 86.68 3.102 157.997 6.035 158.48 6.52.484.483-4.288 95.263-10.604 210.62l-11.484 209.742 5.34 54.448c2.937 29.946 7.164 67.446 9.394 83.333 10.012 71.34 41.15 248.41 49.29 280.29 10.431 40.854 36.898 97.886 71.638 154.37 6.915 11.243 12.371 20.619 12.125 20.836-.246.217-13.347 7.15-29.114 15.406-103.658 54.282-173.18 102.349-229.377 158.589-34.523 34.549-56.008 63.174-73.103 97.394-4.945 9.9-10.29 21.181-11.877 25.069l-2.885 7.068-31.713-.8c-17.441-.44-107.612-1.987-200.378-3.437l-168.667-2.637-138.811 8.702c-140.624 8.816-145.856 9.109-145.856 8.182z"/>
                </svg>
                
                {/*<!-- Plot 13 Updated -->*/}
                <svg className="js-plot-selector" data-property-id="1115" xmlns="http://www.w3.org/2000/svg" width="1299.814" height="1322.3589" viewBox="0 0 1299.814 1322.3589">
                    <path x="0" y="0" width="1299.814" height="1322.3589" fill="#00483A" d="M101.367 1322.359s19.198-454.05 18.38-454.792c-1.202-1.087-1.142-6.894.314-30.062.99-15.793 2.013-29.656 2.27-30.808.651-2.921-84.48-548.074-85.782-549.319-.591-.562-3.893-.55-7.488 0-3.536.575-6.88.588-7.428.065-.837-.838-22.327-241.027-21.616-241.6.13-.104 57.058-3.714 126.504-8.018L252.786 0l174.247 2.866C522.87 4.442 601.738 6.19 602.3 6.75c.575.575-.02 4.332-1.372 8.632-11.465 36.524-10.413 87.016 2.667 127.867 22.257 69.514 78.286 113.46 171.784 129.238 21.48 3.624 48.634 5.743 82.896 7.136 82.25 3.344 129.971 10.957 174.424 27.827 61.863 23.475 122.376 43.523 147.66 100.55 10.22 23.63 35.819 69.566 44.175 117.867 12.097 70.946 28.487 149.289 54.122 251.461 4.448 17.726 21.304 79.225 21.157 79.344-416.142 178.084-657.964 284.434-1198.446 465.686z"/>
                </svg>
                
                {/*<!-- Plot 14 Updated -->*/}
                <svg className="js-plot-selector" data-property-id="1116" xmlns="http://www.w3.org/2000/svg" width="1036" height="1105.333" viewBox="0 0 1036 1105.3333">
                    <path x="0" y="0" width="1036" height="1105.3333" fill="#00483A" d="M292.715 1095.37c-137.21-5.573-237.607-10.174-238.355-10.921-.71-.71-5.18-17.749-9.934-37.864-51.276-216.956-57.84-369.27-21.38-496.161 15.69-54.607 41.94-111.896 71.979-157.09 23.35-35.131 39.884-55.586 106.704-132 47.637-54.48 67.006-77.66 87.173-104.331 40.069-52.99 66.061-99.785 81.47-146.67 1.626-4.95 3.494-9 4.152-9 .657 0 86.779 23.47 191.382 52.157 138.752 38.05 190.456 51.723 191.177 50.556.544-.88 1.77-4.858 2.726-8.84.955-3.982 2.389-7.75 3.186-8.376 1.253-.981 270.625 57.233 272.222 58.831.66.66-63.866 272.544-64.936 273.614-.404.404-6.547-.573-13.65-2.172-9.054-2.038-13.336-2.487-14.321-1.501-.773.773-10.257 29.229-21.076 63.235-19.102 60.045-21.911 67.585-97.312 261.163-42.703 109.633-78.655 200.139-79.893 201.123-1.238.985-48.444 33.816-104.903 72.958-56.46 39.142-102.865 71.804-103.125 72.582-.259.779 1.963 5.298 4.938 10.043l5.41 8.627-8.286-.166c-4.557-.09-114.963-4.5-245.348-9.797z"/>
                </svg>
                </div>
            </div>
        )
    }
}

export default ApRidePlan;